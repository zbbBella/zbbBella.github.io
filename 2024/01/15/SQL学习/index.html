<!DOCTYPE html><html lang="zh-cn"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="SQL基础"><meta name="keywords" content="SQL"><meta name="author" content="Bella"><meta name="copyright" content="Bella"><title>SQL基础 | Bella</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.1"><link rel="stylesheet" href="https://unpkg.com/font-awesome@latest/css/font-awesome.min.css?version=1.9.1"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  hexoVersion: '6.3.0'
} </script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Bella" type="application/atom+xml">
</head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#SQL%E5%9F%BA%E7%A1%80"><span class="toc-number">1.</span> <span class="toc-text">SQL基础</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.</span> <span class="toc-text">1. 数据库简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-DMBS"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1 DMBS</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-1-DBMS%E7%A7%8D%E7%B1%BB"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">1.1.1   DBMS种类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-2-RDBMS-%E5%B8%B8%E8%A7%81%E7%BB%93%E6%9E%84"><span class="toc-number">1.1.1.2.</span> <span class="toc-text">1.1.2 RDBMS  常见结构</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E5%88%9D%E8%AF%86SQL"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.2  初识SQL</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-1-SQL%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%B9%A6%E5%86%99%E8%A7%84%E5%88%99"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">1.2.1 SQL的基本书写规则</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-2-%E5%91%BD%E5%90%8D%E8%A7%84%E5%88%99"><span class="toc-number">1.1.2.2.</span> <span class="toc-text">1.2.2 命名规则</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-5-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.1.2.3.</span> <span class="toc-text">1.2.5 数据类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-6-%E8%AE%BE%E7%BD%AE%E7%BA%A6%E6%9D%9F"><span class="toc-number">1.1.2.4.</span> <span class="toc-text">1.2.6 设置约束</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-7-%E6%B3%A8%E9%87%8A%E8%AF%AD%E5%8F%A5"><span class="toc-number">1.1.2.5.</span> <span class="toc-text">1.2.7 注释语句</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-SQL-%E5%9F%BA%E7%A1%80%E8%AF%AD%E5%8F%A5"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.3 SQL 基础语句</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-1-%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.1.3.1.</span> <span class="toc-text">1.3.1 创建数据库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-2-%E5%88%9B%E5%BB%BA%E8%A1%A8"><span class="toc-number">1.1.3.2.</span> <span class="toc-text">1.3.2 创建表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-3-%E8%A1%A8%E7%9A%84%E5%88%A0%E9%99%A4%E4%B8%8E%E6%9B%B4%E6%96%B0"><span class="toc-number">1.1.3.3.</span> <span class="toc-text">1.3.3 表的删除与更新</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-4-%E6%8F%92%E5%85%A5"><span class="toc-number">1.1.3.4.</span> <span class="toc-text">1.3.4 插入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-%E7%B4%A2%E5%BC%95"><span class="toc-number">1.1.4.</span> <span class="toc-text">1.4  索引</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%9F%BA%E7%A1%80%E6%9F%A5%E8%AF%A2%E4%B8%8E%E6%8E%92%E5%BA%8F"><span class="toc-number">1.2.</span> <span class="toc-text">2. 基础查询与排序</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-SELECT-%E8%AF%AD%E5%8F%A5"><span class="toc-number">1.2.1.</span> <span class="toc-text">2.1 SELECT 语句</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-1-%E7%9B%B8%E5%85%B3%E6%B3%95%E5%88%99"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">2.1.1 相关法则</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.2  运算符</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-1-%E7%AE%97%E6%95%B0%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">2.2.1 算数运算符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-3-%E6%AF%94%E8%BE%83%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">2.2.3 比较运算符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-3-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">1.2.2.3.</span> <span class="toc-text">2.2.3 逻辑运算符</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E8%81%9A%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.2.3.</span> <span class="toc-text">2.3  聚合查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-%E5%AF%B9%E8%A1%A8%E5%88%86%E7%BB%84"><span class="toc-number">1.2.4.</span> <span class="toc-text">2.4 对表分组</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-1-GROUP-BY"><span class="toc-number">1.2.4.1.</span> <span class="toc-text">2.4.1 GROUP BY</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-%E4%B8%BA%E8%81%9A%E5%90%88%E7%BB%93%E6%9E%9C%E6%8C%87%E5%AE%9A%E6%9D%A1%E4%BB%B6"><span class="toc-number">1.2.5.</span> <span class="toc-text">2.5 为聚合结果指定条件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-%E5%AF%B9%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C%E6%8E%92%E5%BA%8F"><span class="toc-number">1.2.6.</span> <span class="toc-text">2.7 对查询结果排序</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-7-1-%E5%88%AB%E5%90%8D"><span class="toc-number">1.2.6.1.</span> <span class="toc-text">2.7.1 别名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-7-2-ORDER-BY-NULL"><span class="toc-number">1.2.6.2.</span> <span class="toc-text">2.7.2 ORDER BY + NULL</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B0%86-NULL-%E5%80%BC%E6%8E%92%E5%9C%A8%E6%9C%AB%E8%A1%8C%EF%BC%8C%E5%90%8C%E6%97%B6%E5%B0%86%E6%89%80%E6%9C%89-%E9%9D%9ENULL-%E5%80%BC%E6%8C%89%E5%8D%87%E5%BA%8F%E6%8E%92%E5%88%97%E3%80%82"><span class="toc-number">1.2.6.2.1.</span> <span class="toc-text">将 NULL 值排在末行，同时将所有 非NULL 值按升序排列。</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%A4%8D%E6%9D%82%E7%9A%84%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.3.</span> <span class="toc-text">3 复杂的查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E8%A7%86%E5%9B%BE"><span class="toc-number">1.3.1.</span> <span class="toc-text">3.1 视图</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-2-%E8%A7%86%E5%9B%BE%E5%88%9B%E5%BB%BA%E5%AE%9E%E4%BE%8B"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">3.1.2 视图创建实例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-3-%E8%A7%86%E5%9B%BE%E4%BF%AE%E6%94%B9"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">3.1.3 视图修改</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-4-%E8%A7%86%E5%9B%BE%E6%9B%B4%E6%96%B0"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">3.1.4 视图更新</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-5-%E5%88%A0%E9%99%A4%E8%A7%86%E5%9B%BE"><span class="toc-number">1.3.1.4.</span> <span class="toc-text">3.1.5 删除视图</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.3.2.</span> <span class="toc-text">3.2  子查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-1-%E5%B5%8C%E5%A5%97%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">3.2.1 嵌套子查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-2-%E6%A0%87%E9%87%8F%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">3.2.2 标量子查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-3%E5%85%B3%E8%81%94%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.3.2.3.</span> <span class="toc-text">3.3.3关联子查询</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E9%9B%86%E5%90%88%E8%BF%90%E7%AE%97"><span class="toc-number">1.4.</span> <span class="toc-text">4 集合运算</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E8%A1%A8%E7%9A%84%E5%8A%A0%E5%87%8F%E8%BF%90%E7%AE%97"><span class="toc-number">1.4.1.</span> <span class="toc-text">4.1 表的加减运算</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-1-%E5%8A%A0%E6%B3%95-%E2%80%94-UNION"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">4.1.1 加法 —- UNION</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-2-%E4%BA%A4%E9%9B%86"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">4.1.2 交集</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-3-%E5%B7%AE%E9%9B%86%E3%80%81%E8%A1%A5%E9%9B%86%E4%B8%8E%E8%A1%A8%E7%9A%84%E5%87%8F%E6%B3%95"><span class="toc-number">1.4.1.3.</span> <span class="toc-text">4.1.3 差集、补集与表的减法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E8%BF%9E%E7%BB%93-JOIN"><span class="toc-number">1.4.2.</span> <span class="toc-text">4.2 连结  JOIN</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-1-%E5%86%85%E8%BF%9E%E7%BB%93-%E2%80%94-INNER-JOIN"><span class="toc-number">1.4.2.1.</span> <span class="toc-text">4.2.1 内连结  —- INNER JOIN</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-2-%E8%87%AA%E8%BF%9E%E7%BB%93-%E2%80%94-SELF-JOIN"><span class="toc-number">1.4.2.2.</span> <span class="toc-text">4.2.2 自连结 —- SELF JOIN</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-4-%E8%87%AA%E7%84%B6%E8%BF%9E%E7%BB%93-%E2%80%94-NATURAL-JOIN"><span class="toc-number">1.4.2.3.</span> <span class="toc-text">4.2.4 自然连结 —- NATURAL JOIN</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E5%A4%96%E8%BF%9E%E7%BB%93-%E2%80%94-OUTER-JOIN"><span class="toc-number">1.4.3.</span> <span class="toc-text">4.3  外连结 —- OUTER JOIN</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-1-%E5%B7%A6%E8%BF%9E%E7%BB%93%EF%BC%88LEFT-JOIN%EF%BC%89%E5%92%8C%E5%8F%B3%E8%BF%9E%E7%BB%93%EF%BC%88RIGHT-JOIN%EF%BC%89"><span class="toc-number">1.4.3.1.</span> <span class="toc-text">4.3.1 左连结（LEFT JOIN）和右连结（RIGHT JOIN）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-2-%E5%B7%A6%E8%BF%9E%E7%BB%93-%E2%80%94-LEFT-JOIN"><span class="toc-number">1.4.3.2.</span> <span class="toc-text">4.3.2 左连结 —- LEFT JOIN</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">Bella</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">35</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">18</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">6</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/breathecc.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Bella</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span><span class="pull-right"></span></div><div id="post-info"><div id="post-title">SQL基础</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2024-01-15</time></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="SQL基础"><a href="#SQL基础" class="headerlink" title="SQL基础"></a>SQL基础</h1><h2 id="1-数据库简介"><a href="#1-数据库简介" class="headerlink" title="1. 数据库简介"></a>1. 数据库简介</h2><p>数据库是将大量数据保存起来，通过计算机加工而成的可以进行高效访问的数据集合。该数据集合称为数据库（Database，DB）。用来管理数据库的计算机系统称为数据库管理系统（Database Management System，DBMS）。</p>
<h3 id="1-1-DMBS"><a href="#1-1-DMBS" class="headerlink" title="1.1 DMBS"></a>1.1 DMBS</h3><h4 id="1-1-1-DBMS种类"><a href="#1-1-1-DBMS种类" class="headerlink" title="1.1.1   DBMS种类"></a>1.1.1   DBMS种类</h4><p>DBMS 主要通过数据的保存格式（数据库的种类）来进行分类，现阶段主要有以下 5 种类型.</p>
<ul>
<li><p>层次数据库（Hierarchical Database，HDB）</p>
</li>
<li><p>关系数据库（Relational Database，RDB）</p>
<ul>
<li>Oracle Database：甲骨文公司的 RDBMS</li>
<li>SQL Server：微软公司的 RDBMS</li>
<li>DB2：IBM公司的 RDBMS</li>
<li>PostgreSQL：开源的 RDBMS</li>
<li>MySQL：开源的 RDBMS</li>
</ul>
<p>如上是5种具有代表性的 RDBMS，其特点是由行和列组成的二维表来管理数据，这种类型的 DBMS 称为关系数据库管理系统（Relational Database Management System，RDBMS）。</p>
</li>
<li><p>面向对象数据库（Object Oriented Database，OODB）</p>
</li>
<li><p>XML数据库（XML Database，XMLDB）</p>
</li>
<li><p>键值存储系统（Key-Value Store，KVS），举例：MongoDB</p>
</li>
</ul>
<h4 id="1-1-2-RDBMS-常见结构"><a href="#1-1-2-RDBMS-常见结构" class="headerlink" title="1.1.2 RDBMS  常见结构"></a>1.1.2 RDBMS  常见结构</h4><p>最常见的是是客户端 &#x2F; 服务器类型（C&#x2F;S类型）</p>
<p><img src="https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/15/192912-236011.png" alt="image-20240115192911499"></p>
<h3 id="1-2-初识SQL"><a href="#1-2-初识SQL" class="headerlink" title="1.2  初识SQL"></a>1.2  初识SQL</h3><p><img src="https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/15/193557-158279.png" alt="image-20240115193557157"></p>
<p>SQL 语句可分为3类：</p>
<ul>
<li><strong>DDL</strong> ：DDL（Data Definition Language，数据定义语言） 用来创建或者删除存储数据用的数据库以及数据库中的表等对象。DDL 包含以下几种指令。<ul>
<li>CREATE ： 创建数据库和表等对象</li>
<li>DROP ： 删除数据库和表等对象</li>
<li>ALTER ： 修改数据库和表等对象的结构</li>
</ul>
</li>
<li><strong>DML</strong> :DML（Data Manipulation Language，数据操纵语言） 用来查询或者变更表中的记录。DML 包含以下几种指令。<ul>
<li>SELECT ：查询表中的数据</li>
<li>INSERT ：向表中插入新数据</li>
<li>UPDATE ：更新表中的数据</li>
<li>DELETE ：删除表中的数据</li>
</ul>
</li>
<li><strong>DCL</strong> ：DCL（Data Control Language，数据控制语言） 用来确认或者取消对数据库中的数据进行的变更。除此之外，还可以对 RDBMS 的用户是否有权限操作数据库中的对象（数据库表等）进行设定。DCL 包含以下几种指令。<ul>
<li>COMMIT ： 确认对数据库中的数据进行的变更</li>
<li>ROLLBACK ： 取消对数据库中的数据进行的变更</li>
<li>GRANT ： 赋予用户操作权限</li>
<li>REVOKE ： 取消用户的操作权限</li>
</ul>
</li>
</ul>
<p>实际使用的 SQL 语句当中有 90% 属于 DML</p>
<h4 id="1-2-1-SQL的基本书写规则"><a href="#1-2-1-SQL的基本书写规则" class="headerlink" title="1.2.1 SQL的基本书写规则"></a>1.2.1 SQL的基本书写规则</h4><ul>
<li>SQL语句要以分号（ ; ）结尾</li>
<li>SQL 不区分关键字的大小写，但是插入到表中的数据是区分大小写的</li>
<li>win 系统默认不区分表名及字段名的大小写</li>
<li>linux &#x2F; mac 默认严格区分表名及字段名的大小写</li>
<li>常数的书写方式是固定的</li>
</ul>
<p><code>&#39;abc&#39;</code>, <code>1234</code>, <code>&#39;26 Jan 2010&#39;</code>, <code>&#39;10/01/26&#39;</code>, <code>&#39;2010-01-26&#39;</code>……</p>
<ul>
<li>单词需要用半角空格或者换行来分隔</li>
</ul>
<p>SQL 语句的单词之间需使用<strong>半角空格或换行符来进行分隔</strong>，且不能使用全角空格作为单词的分隔符，否则会发生错误，出现无法预期的结果。</p>
<h4 id="1-2-2-命名规则"><a href="#1-2-2-命名规则" class="headerlink" title="1.2.2 命名规则"></a>1.2.2 命名规则</h4><ul>
<li>只能使用半角英文字母、数字、下划线（_）作为数据库、表和列的名称</li>
<li>名称必须以半角英文字母开头</li>
</ul>
<p><img src="https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/15/194619-408451.png" alt="image-20240115194618415"></p>
<h4 id="1-2-5-数据类型"><a href="#1-2-5-数据类型" class="headerlink" title="1.2.5 数据类型"></a>1.2.5 数据类型</h4><p>数据库创建的表，所有的列都必须指定数据类型，每一列都不能存储与该列数据类型不符的数据。四种最基本的数据类型</p>
<ul>
<li>INTEGER 型</li>
</ul>
<p>用来指定存储整数的列的数据类型（数字型），不能存储小数。</p>
<ul>
<li>CHAR 型</li>
</ul>
<p>用来存储定长字符串，当列中存储的字符串长度达不到最大长度的时候，使用半角空格进行补足，由于会浪费存储空间，所以一般不使用。</p>
<ul>
<li>VARCHAR 型</li>
</ul>
<p>用来存储可变长度字符串，定长字符串在字符数未达到最大长度时会用半角空格补足，但可变长字符串不同，即使字符数未达到最大长度，也不会用半角空格补足。</p>
<ul>
<li>DATE 型</li>
</ul>
<p>用来指定存储日期（年月日）的列的数据类型（日期型）。</p>
<h4 id="1-2-6-设置约束"><a href="#1-2-6-设置约束" class="headerlink" title="1.2.6 设置约束"></a>1.2.6 设置约束</h4><p>约束是除了数据类型之外，对列中存储的数据进行限制或者追加条件的功能。</p>
<p><code>NOT NULL</code>是非空约束，即该列必须输入数据。</p>
<p><code>PRIMARY KEY</code>是主键约束，代表该列是唯一值，可以通过该列取出特定的行的数据。</p>
<h4 id="1-2-7-注释语句"><a href="#1-2-7-注释语句" class="headerlink" title="1.2.7 注释语句"></a>1.2.7 注释语句</h4><p>注释是SQL语句中用来标识说明或者注意事项的部分。分为1行注释”– “和多行注释两种”&#x2F;* *&#x2F;“。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 一行</span></span><br><span class="line"><span class="comment">/* 多行 </span></span><br><span class="line"><span class="comment">多行 </span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>



<h3 id="1-3-SQL-基础语句"><a href="#1-3-SQL-基础语句" class="headerlink" title="1.3 SQL 基础语句"></a>1.3 SQL 基础语句</h3><h4 id="1-3-1-创建数据库"><a href="#1-3-1-创建数据库" class="headerlink" title="1.3.1 创建数据库"></a>1.3.1 创建数据库</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE <span class="operator">&lt;</span>数据库名字<span class="operator">&gt;</span>;</span><br><span class="line"><span class="comment">/* 本例 */</span></span><br><span class="line"><span class="keyword">CREATE</span> DATABASE shop;</span><br></pre></td></tr></table></figure>

<h4 id="1-3-2-创建表"><a href="#1-3-2-创建表" class="headerlink" title="1.3.2 创建表"></a>1.3.2 创建表</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span> 表名 <span class="operator">&gt;</span></span><br><span class="line">( <span class="operator">&lt;</span> 列名 <span class="number">1</span><span class="operator">&gt;</span> <span class="operator">&lt;</span> 数据类型 <span class="operator">&gt;</span> <span class="operator">&lt;</span> 该列所需约束 <span class="operator">&gt;</span> ,</span><br><span class="line">  <span class="operator">&lt;</span> 列名 <span class="number">2</span><span class="operator">&gt;</span> <span class="operator">&lt;</span> 数据类型 <span class="operator">&gt;</span> <span class="operator">&lt;</span> 该列所需约束 <span class="operator">&gt;</span> ,</span><br><span class="line">  <span class="operator">&lt;</span> 列名 <span class="number">3</span><span class="operator">&gt;</span> <span class="operator">&lt;</span> 数据类型 <span class="operator">&gt;</span> <span class="operator">&lt;</span> 该列所需约束 <span class="operator">&gt;</span> ,</span><br><span class="line">  <span class="operator">&lt;</span> 列名 <span class="number">4</span><span class="operator">&gt;</span> <span class="operator">&lt;</span> 数据类型 <span class="operator">&gt;</span> <span class="operator">&lt;</span> 该列所需约束 <span class="operator">&gt;</span> ,</span><br><span class="line">  .</span><br><span class="line">  .</span><br><span class="line">  .</span><br><span class="line">  <span class="operator">&lt;</span> 该表的约束 <span class="number">1</span><span class="operator">&gt;</span> , <span class="operator">&lt;</span> 该表的约束 <span class="number">2</span><span class="operator">&gt;</span> ,……);</span><br><span class="line">  <span class="comment">/* 本例 */</span></span><br><span class="line">  <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> product</span><br><span class="line">(product_id <span class="type">CHAR</span>(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line"> product_name <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line"> product_type <span class="type">VARCHAR</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line"> sale_price <span class="type">INTEGER</span> ,</span><br><span class="line"> purchase_price <span class="type">INTEGER</span> ,</span><br><span class="line"> regist_date <span class="type">DATE</span> ,</span><br><span class="line"> <span class="keyword">PRIMARY</span> KEY (product_id));</span><br></pre></td></tr></table></figure>

<h4 id="1-3-3-表的删除与更新"><a href="#1-3-3-表的删除与更新" class="headerlink" title="1.3.3 表的删除与更新"></a>1.3.3 表的删除与更新</h4><ul>
<li>删除</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span> 表名 <span class="operator">&gt;</span> ;</span><br></pre></td></tr></table></figure>

<ul>
<li>添加、删除列</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 添加 */</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span> 表名 <span class="operator">&gt;</span> <span class="keyword">ADD</span> <span class="keyword">COLUMN</span> <span class="operator">&lt;</span> 列的定义 <span class="operator">&gt;</span>;</span><br><span class="line"><span class="comment">/* 删除 */</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span> 表名 <span class="operator">&gt;</span> <span class="keyword">DROP</span> <span class="keyword">COLUMN</span> <span class="operator">&lt;</span> 列名 <span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>删除表中特定行</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 一定注意添加 WHERE 条件，否则将会删除所有的数据</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> product <span class="keyword">WHERE</span> COLUMN_NAME<span class="operator">=</span><span class="string">&#x27;XXX&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>ALTER TABLE 语句和 DROP TABLE 语句一样，执行之后无法恢复。误添加的列可以通过 ALTER TABLE 语句删除，或者将表全部删除之后重新再创建。</p>
<ul>
<li>清空表</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> TABLE_NAME;</span><br></pre></td></tr></table></figure>

<p>优点：相比<code>drop / delete</code>，<code>truncate</code>用来清除数据时，速度最快。</p>
<p> 例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 删除product表 */</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> product;</span><br><span class="line"><span class="comment">/* 添加一列可以存储100位的可变长字符串的 product_name_pinyin 列 */</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> product <span class="keyword">ADD</span> <span class="keyword">COLUMN</span> product_name_pinyin <span class="type">VARCHAR</span>(<span class="number">100</span>);</span><br><span class="line"><span class="comment">/* 删除 product_name_pinyin 列 */</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> product <span class="keyword">DROP</span> <span class="keyword">COLUMN</span> product_name_pinyin;</span><br></pre></td></tr></table></figure>



<ul>
<li>更新数据</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 单个数据更新 */</span></span><br><span class="line"><span class="keyword">UPDATE</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span></span><br><span class="line">   <span class="keyword">SET</span> <span class="operator">&lt;</span>列名<span class="operator">&gt;</span> <span class="operator">=</span> <span class="operator">&lt;</span>表达式<span class="operator">&gt;</span> [, <span class="operator">&lt;</span>列名<span class="number">2</span><span class="operator">&gt;=</span><span class="operator">&lt;</span>表达式<span class="number">2</span><span class="operator">&gt;</span>...]  </span><br><span class="line"> <span class="keyword">WHERE</span> <span class="operator">&lt;</span>条件<span class="operator">&gt;</span>  <span class="comment">-- optional，非常重要。否则将会将所有的行按照语句修改</span></span><br><span class="line"> <span class="keyword">ORDER</span> <span class="keyword">BY</span> 子句  <span class="comment">-- optional </span></span><br><span class="line"> LIMIT 子句; <span class="comment">-- optional</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">/* 多列数据更新 */</span></span><br><span class="line"><span class="comment">-- UPDATE 语句的 SET 子句支持同时将多个列作为更新对象。</span></span><br></pre></td></tr></table></figure>

<p>例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 修改所有的注册时间</span></span><br><span class="line"><span class="keyword">UPDATE</span> product</span><br><span class="line">   <span class="keyword">SET</span> regist_date <span class="operator">=</span> <span class="string">&#x27;2009-10-10&#x27;</span>;  </span><br><span class="line"><span class="comment">-- 仅修改部分商品的单价</span></span><br><span class="line"><span class="keyword">UPDATE</span> product</span><br><span class="line">   <span class="keyword">SET</span> sale_price <span class="operator">=</span> sale_price <span class="operator">*</span> <span class="number">10</span></span><br><span class="line"> <span class="keyword">WHERE</span> product_type <span class="operator">=</span> <span class="string">&#x27;厨房用具&#x27;</span>;  </span><br><span class="line"> </span><br><span class="line"> <span class="comment">-- 基础写法，一条UPDATE语句只更新一列</span></span><br><span class="line"><span class="keyword">UPDATE</span> product</span><br><span class="line">   <span class="keyword">SET</span> sale_price <span class="operator">=</span> sale_price <span class="operator">*</span> <span class="number">10</span></span><br><span class="line"> <span class="keyword">WHERE</span> product_type <span class="operator">=</span> <span class="string">&#x27;厨房用具&#x27;</span>;</span><br><span class="line"><span class="keyword">UPDATE</span> product</span><br><span class="line">   <span class="keyword">SET</span> purchase_price <span class="operator">=</span> purchase_price <span class="operator">/</span> <span class="number">2</span></span><br><span class="line"> <span class="keyword">WHERE</span> product_type <span class="operator">=</span> <span class="string">&#x27;厨房用具&#x27;</span>;  </span><br><span class="line"> <span class="comment">-- 合并版</span></span><br><span class="line"><span class="keyword">UPDATE</span> product</span><br><span class="line">   <span class="keyword">SET</span> sale_price <span class="operator">=</span> sale_price <span class="operator">*</span> <span class="number">10</span>,</span><br><span class="line">       purchase_price <span class="operator">=</span> purchase_price <span class="operator">/</span> <span class="number">2</span></span><br><span class="line"> <span class="keyword">WHERE</span> product_type <span class="operator">=</span> <span class="string">&#x27;厨房用具&#x27;</span>;  </span><br></pre></td></tr></table></figure>

<ul>
<li>NULL清空</li>
</ul>
<p>将列更新为NULL（可作为一个值使用）。</p>
<p>只有未设置 NOT NULL 约束和主键约束的列才可以清空为NULL。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 将商品编号为0008的数据（圆珠笔）的登记日期更新为NULL  </span></span><br><span class="line"><span class="keyword">UPDATE</span> product</span><br><span class="line">   <span class="keyword">SET</span> regist_date <span class="operator">=</span> <span class="keyword">NULL</span></span><br><span class="line"> <span class="keyword">WHERE</span> product_id <span class="operator">=</span> <span class="string">&#x27;0008&#x27;</span>;  </span><br></pre></td></tr></table></figure>

<h4 id="1-3-4-插入"><a href="#1-3-4-插入" class="headerlink" title="1.3.4 插入"></a>1.3.4 插入</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span> (列<span class="number">1</span>, 列<span class="number">2</span>, 列<span class="number">3</span>, ……) <span class="keyword">VALUES</span> (值<span class="number">1</span>, 值<span class="number">2</span>, 值<span class="number">3</span>, ……);  </span><br></pre></td></tr></table></figure>

<p>对表进行全列 INSERT 时，可以省略表名后的列清单。这时 VALUES子句的值会默认按照从左到右的顺序赋给每一列。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 包含列清单</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> productins (product_id, product_name, product_type, sale_price, purchase_price, regist_date) <span class="keyword">VALUES</span> (<span class="string">&#x27;0005&#x27;</span>, <span class="string">&#x27;高压锅&#x27;</span>, <span class="string">&#x27;厨房用具&#x27;</span>, <span class="number">6800</span>, <span class="number">5000</span>, <span class="string">&#x27;2009-01-15&#x27;</span>);</span><br><span class="line"><span class="comment">-- 省略列清单</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> productins <span class="keyword">VALUES</span> (<span class="string">&#x27;0005&#x27;</span>, <span class="string">&#x27;高压锅&#x27;</span>, <span class="string">&#x27;厨房用具&#x27;</span>, <span class="number">6800</span>, <span class="number">5000</span>, <span class="string">&#x27;2009-01-15&#x27;</span>);  </span><br></pre></td></tr></table></figure>

<p>原则上，执行一次 INSERT 语句会插入一行数据。插入多行时，通常需要循环执行相应次数的 INSERT 语句。其实很多 RDBMS 都支持一次插入多行数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 通常的INSERT</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> productins <span class="keyword">VALUES</span> (<span class="string">&#x27;0002&#x27;</span>, <span class="string">&#x27;打孔器&#x27;</span>, <span class="string">&#x27;办公用品&#x27;</span>, <span class="number">500</span>, <span class="number">320</span>, <span class="string">&#x27;2009-09-11&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> productins <span class="keyword">VALUES</span> (<span class="string">&#x27;0003&#x27;</span>, <span class="string">&#x27;运动T恤&#x27;</span>, <span class="string">&#x27;衣服&#x27;</span>, <span class="number">4000</span>, <span class="number">2800</span>, <span class="keyword">NULL</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> productins <span class="keyword">VALUES</span> (<span class="string">&#x27;0004&#x27;</span>, <span class="string">&#x27;菜刀&#x27;</span>, <span class="string">&#x27;厨房用具&#x27;</span>, <span class="number">3000</span>, <span class="number">2800</span>, <span class="string">&#x27;2009-09-20&#x27;</span>);</span><br><span class="line"><span class="comment">-- 多行INSERT （ DB2、SQL、SQL Server、 PostgreSQL 和 MySQL多行插入）</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> productins <span class="keyword">VALUES</span> (<span class="string">&#x27;0002&#x27;</span>, <span class="string">&#x27;打孔器&#x27;</span>, <span class="string">&#x27;办公用品&#x27;</span>, <span class="number">500</span>, <span class="number">320</span>, <span class="string">&#x27;2009-09-11&#x27;</span>),</span><br><span class="line">                              (<span class="string">&#x27;0003&#x27;</span>, <span class="string">&#x27;运动T恤&#x27;</span>, <span class="string">&#x27;衣服&#x27;</span>, <span class="number">4000</span>, <span class="number">2800</span>, <span class="keyword">NULL</span>),</span><br><span class="line">                              (<span class="string">&#x27;0004&#x27;</span>, <span class="string">&#x27;菜刀&#x27;</span>, <span class="string">&#x27;厨房用具&#x27;</span>, <span class="number">3000</span>, <span class="number">2800</span>, <span class="string">&#x27;2009-09-20&#x27;</span>);  </span><br><span class="line"><span class="comment">-- Oracle中的多行INSERT</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">ALL</span> <span class="keyword">INTO</span> productins <span class="keyword">VALUES</span> (<span class="string">&#x27;0002&#x27;</span>, <span class="string">&#x27;打孔器&#x27;</span>, <span class="string">&#x27;办公用品&#x27;</span>, <span class="number">500</span>, <span class="number">320</span>, <span class="string">&#x27;2009-09-11&#x27;</span>)</span><br><span class="line">           <span class="keyword">INTO</span> productins <span class="keyword">VALUES</span> (<span class="string">&#x27;0003&#x27;</span>, <span class="string">&#x27;运动T恤&#x27;</span>, <span class="string">&#x27;衣服&#x27;</span>, <span class="number">4000</span>, <span class="number">2800</span>, <span class="keyword">NULL</span>)</span><br><span class="line">           <span class="keyword">INTO</span> productins <span class="keyword">VALUES</span> (<span class="string">&#x27;0004&#x27;</span>, <span class="string">&#x27;菜刀&#x27;</span>, <span class="string">&#x27;厨房用具&#x27;</span>, <span class="number">3000</span>, <span class="number">2800</span>, <span class="string">&#x27;2009-09-20&#x27;</span>)</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> DUAL;  </span><br><span class="line"><span class="comment">-- DUAL是Oracle特有（安装时的必选项）的一种临时表A。因此“SELECT *FROM DUAL” 部分也只是临时性的，并没有实际意义。  </span></span><br></pre></td></tr></table></figure>

<ul>
<li>使用 <code>INSERT</code>复制其他表的数据</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 将商品表中的数据复制到商品复制表中</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> productcopy (product_id, product_name, product_type, sale_price, purchase_price, regist_date)</span><br><span class="line"><span class="keyword">SELECT</span> product_id, product_name, product_type, sale_price, purchase_price, regist_date</span><br><span class="line">  <span class="keyword">FROM</span> Product;  </span><br></pre></td></tr></table></figure>

<h3 id="1-4-索引"><a href="#1-4-索引" class="headerlink" title="1.4  索引"></a>1.4  索引</h3><p>作用：可以大大提高MySQL的检索速度。索引创建了一种有序的数据结构，采用二分法搜索数据时，其复杂度为 <img src="http://latex.codecogs.com/svg.latex?log_2(N)" alt="1"> ，1000多万的数据只要搜索23次，其效率是非常高效的。</p>
<ul>
<li>创建索引</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> mytable(  </span><br><span class="line">ID <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,   </span><br><span class="line">username <span class="type">VARCHAR</span>(<span class="number">16</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,  </span><br><span class="line">INDEX [indexName] (username(length))  </span><br><span class="line">);  </span><br><span class="line"></span><br><span class="line"><span class="comment">-- 方法1</span></span><br><span class="line"><span class="keyword">CREATE</span> INDEX indexName <span class="keyword">ON</span> table_name (column_name)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 方法2</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">table</span> tableName <span class="keyword">ADD</span> INDEX indexName(columnName)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li><p>索引分类</p>
<ul>
<li><p>主键索引</p>
<ul>
<li>建立在主键上的索引被称为主键索引</li>
<li>一张数据表只能有一个主键索引</li>
<li>索引列值不允许有空值，通常在创建表时一起创建。</li>
</ul>
</li>
<li><p>唯一索引</p>
<ul>
<li>建立在<code>UNIQUE</code>字段上的索引被称为唯一索引</li>
<li>一张表可以有多个唯一索引</li>
<li>索引列值允许为空，列值中出现多个空值不会发生重复冲突。</li>
</ul>
</li>
<li><p>普通索引</p>
<ul>
<li>建立在普通字段上的索引被称为普通索引。</li>
</ul>
</li>
<li><p>前缀索引</p>
<ul>
<li>前缀索引是指对字符类型字段的前几个字符或对二进制类型字段的前几个bytes建立的索引，而不是在整个字段上建索引。</li>
<li>前缀索引可以建立在类型为char、varchar、binary、varbinary的列上，可以大大减少索引占用的存储空间，也能提升索引的查询效率。</li>
</ul>
</li>
<li><p>全文索引</p>
<ul>
<li><p>利用“分词技术”实现在长文本中搜索关键字的一种索引。</p>
<p>语法：<code>SELECT * FROM article WHERE MATCH (col1，col2，...) AGAINST (expr [ search _ modifier ])</code></p>
<p>1、MySQL 5.6 以前的版本，只有 MyISAM 存储引擎支持全文索引；</p>
<p>2、MySQL 5.6 及以后的版本，MyISAM 和 InnoDB 存储引擎均支持全文索引;</p>
<p>3、只有字段的数据类型为 char、varchar、text 及其系列才可以建全文索引。</p>
<p>4、如果可能，请尽量先创建表并插入所有数据后再创建全文索引，而不要在创建表时就直接创建全文索引，因为前者比后者的全文索引效率要高。</p>
</li>
</ul>
</li>
<li><p>单列索引</p>
<ul>
<li>建立在单个列上的索引被称为单列索引。</li>
</ul>
</li>
<li><p>联合索引（复合索引、多列索引）</p>
<ul>
<li>建立在多个列上的索引被称为联合索引，又叫复合索引、组合索引。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="2-基础查询与排序"><a href="#2-基础查询与排序" class="headerlink" title="2. 基础查询与排序"></a>2. 基础查询与排序</h2><h3 id="2-1-SELECT-语句"><a href="#2-1-SELECT-语句" class="headerlink" title="2.1 SELECT 语句"></a>2.1 SELECT 语句</h3><ul>
<li>从表中选数据</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 从表中选数据</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">&lt;</span>列名<span class="operator">&gt;</span>, </span><br><span class="line">  <span class="keyword">FROM</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span>;</span><br><span class="line">  </span><br><span class="line"><span class="comment">-- 从表中选符合条件的数据</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">&lt;</span>列名<span class="operator">&gt;</span>, ……</span><br><span class="line">  <span class="keyword">FROM</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span></span><br><span class="line"> <span class="keyword">WHERE</span> <span class="operator">&lt;</span>条件表达式<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure>

<p>其中，SELECT子句中列举了希望从表中查询出的列的名称，而FROM子句则指定了选取出数据的表的名称。在WHERE 子句中可以指定“某一列的值和这个字符串相等”或者“某一列的值大于这个数字”等条件。执行含有这些条件的SELECT语句，就可以查询出只符合该条件的记录了。</p>
<p>例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 用来选取product type列为衣服的记录的SELECT语句</span></span><br><span class="line"><span class="keyword">SELECT</span> product_name, product_type</span><br><span class="line">  <span class="keyword">FROM</span> product</span><br><span class="line"> <span class="keyword">WHERE</span> product_type <span class="operator">=</span> <span class="string">&#x27;衣服&#x27;</span>;</span><br><span class="line"><span class="comment">-- 也可以选取出不是查询条件的列（条件列与输出列不同）</span></span><br><span class="line"><span class="keyword">SELECT</span> product_name</span><br><span class="line">  <span class="keyword">FROM</span> product</span><br><span class="line"> <span class="keyword">WHERE</span> product_type <span class="operator">=</span> <span class="string">&#x27;衣服&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/17/175507-157149.png" alt="image-20240117175500706"><img src="https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/17/175513-54096.png" alt="image-20240117175509292"></p>
<h4 id="2-1-1-相关法则"><a href="#2-1-1-相关法则" class="headerlink" title="2.1.1 相关法则"></a>2.1.1 相关法则</h4><ul>
<li>星号（*）代表全部列的意思。</li>
<li>SQL中可以随意使用换行符，不影响语句执行（但不可插入空行）。</li>
<li>设定汉语别名时需要使用双引号（”）括起来。</li>
<li>在SELECT语句中使用DISTINCT可以删除重复行。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 想要查询出全部列时，可以使用代表所有列的星号（*）。</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">  <span class="keyword">FROM</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span>；</span><br><span class="line"><span class="comment">-- SQL语句可以使用AS关键字为列设定别名（用中文时需要双引号（“”））。</span></span><br><span class="line"><span class="keyword">SELECT</span> product_id     <span class="keyword">As</span> id,</span><br><span class="line">       product_name   <span class="keyword">As</span> name,</span><br><span class="line">       purchase_price <span class="keyword">AS</span> &quot;进货单价&quot;</span><br><span class="line">  <span class="keyword">FROM</span> product;</span><br><span class="line"><span class="comment">-- 使用DISTINCT删除product_type列中重复的数据</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> product_type</span><br><span class="line">  <span class="keyword">FROM</span> product;</span><br></pre></td></tr></table></figure>

<p><img src="https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/17/180308-835778.png" alt="image-20240117180304451"><img src="https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/17/180321-19684.png" alt="image-20240117180314998"></p>
<ul>
<li>SELECT子句中可以使用常数或者表达式。</li>
<li>使用比较运算符时一定要注意不等号和等号的位置。</li>
<li>字符串类型的数据原则上按照字典顺序进行排序，不能与数字的大小顺序混淆。</li>
<li>希望选取NULL记录时，需要在条件表达式中使用IS NULL运算符。希望选取不是NULL的记录时，需要在条件表达式中使用IS NOT NULL运算符。</li>
</ul>
<h3 id="2-2-运算符"><a href="#2-2-运算符" class="headerlink" title="2.2  运算符"></a>2.2  运算符</h3><h4 id="2-2-1-算数运算符"><a href="#2-2-1-算数运算符" class="headerlink" title="2.2.1 算数运算符"></a>2.2.1 算数运算符</h4><p>SQL语句中可以使用的四则运算的主要运算符如下：</p>
<table>
<thead>
<tr>
<th align="left">含义</th>
<th align="left">运算符</th>
</tr>
</thead>
<tbody><tr>
<td align="left">加法</td>
<td align="left">+</td>
</tr>
<tr>
<td align="left">减法</td>
<td align="left">-</td>
</tr>
<tr>
<td align="left">乘法</td>
<td align="left">*</td>
</tr>
<tr>
<td align="left">除法</td>
<td align="left">&#x2F;</td>
</tr>
</tbody></table>
<p>例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 选取出sale_price列为500的记录</span></span><br><span class="line"><span class="keyword">SELECT</span> product_name, product_type</span><br><span class="line">  <span class="keyword">FROM</span> product</span><br><span class="line"> <span class="keyword">WHERE</span> sale_price <span class="operator">=</span> <span class="number">500</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/17/191237-474673.png" alt="image-20240117190839293"></p>
<h4 id="2-2-3-比较运算符"><a href="#2-2-3-比较运算符" class="headerlink" title="2.2.3 比较运算符"></a>2.2.3 比较运算符</h4><p>SQL常见比较运算符如下：</p>
<table>
<thead>
<tr>
<th align="left">运算符</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">&#x3D;</td>
<td align="left">和 ~ 相等</td>
</tr>
<tr>
<td align="left">&lt;&gt;</td>
<td align="left">和 ~ 不相等</td>
</tr>
<tr>
<td align="left">&gt;&#x3D;</td>
<td align="left">大于等于 ~</td>
</tr>
<tr>
<td align="left">&gt;</td>
<td align="left">大于 ~</td>
</tr>
<tr>
<td align="left">&lt;&#x3D;</td>
<td align="left">小于等于 ~</td>
</tr>
<tr>
<td align="left">&lt;</td>
<td align="left">小于 ~</td>
</tr>
</tbody></table>
<p>例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- SQL语句中也可以使用运算表达式</span></span><br><span class="line"><span class="keyword">SELECT</span> product_name, sale_price, sale_price <span class="operator">*</span> <span class="number">2</span> <span class="keyword">AS</span> &quot;sale_price x2&quot;</span><br><span class="line">  <span class="keyword">FROM</span> product;</span><br><span class="line"><span class="comment">-- WHERE子句的条件表达式中也可以使用计算表达式</span></span><br><span class="line"><span class="keyword">SELECT</span> product_name, sale_price, purchase_price</span><br><span class="line">  <span class="keyword">FROM</span> product</span><br><span class="line"> <span class="keyword">WHERE</span> sale_price <span class="operator">-</span> purchase_price <span class="operator">&gt;=</span> <span class="number">500</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/17/191313-517736.png" alt="image-20240117191307665"><img src="https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/17/191314-914853.png" alt="image-20240117191313859"></p>
<h4 id="2-2-3-逻辑运算符"><a href="#2-2-3-逻辑运算符" class="headerlink" title="2.2.3 逻辑运算符"></a>2.2.3 逻辑运算符</h4><ul>
<li>NOT</li>
</ul>
<p>想要表示 <code>不是……</code> 时，除了前文的&lt;&gt;运算符外，还存在另外一个表示否定、使用范围更广的运算符：NOT。NOT不能单独使用，必须和其他查询条件组合起来使用。</p>
<p><code>NOT sale_price &gt;= 1000</code> 与 <code>sale_price &lt; 1000</code> 是等价的。</p>
<ul>
<li>AND 与 OR</li>
</ul>
<p>AND：交集</p>
<p>OR：并集</p>
<p>注意：AND优先于OR</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 通过使用括号让OR运算符先于AND运算符执行</span></span><br><span class="line"><span class="keyword">SELECT</span> product_name, product_type, regist_date</span><br><span class="line">  <span class="keyword">FROM</span> product</span><br><span class="line"> <span class="keyword">WHERE</span> product_type <span class="operator">=</span> <span class="string">&#x27;办公用品&#x27;</span></span><br><span class="line">   <span class="keyword">AND</span> ( regist_date <span class="operator">=</span> <span class="string">&#x27;2009-09-11&#x27;</span></span><br><span class="line">        <span class="keyword">OR</span> regist_date <span class="operator">=</span> <span class="string">&#x27;2009-09-20&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>优先级：</p>
<p><img src="https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/17/191831-773922.png" alt="image-20240117191830955"></p>
<h3 id="2-3-聚合查询"><a href="#2-3-聚合查询" class="headerlink" title="2.3  聚合查询"></a>2.3  聚合查询</h3><p>SQL中用于汇总的函数叫做聚合函数。</p>
<ul>
<li>SUM：计算表中某数值列中的合计值</li>
<li>AVG：计算表中某数值列中的平均值</li>
<li>MAX：计算表中任意列中数据的最大值，包括文本类型和数字类型</li>
<li>MIN：计算表中任意列中数据的最小值，包括文本类型和数字类型</li>
<li>COUNT：计算表中的记录条数（行数）</li>
<li>DISTINCT：删除重复值<ul>
<li>比如：要计算总共有几种咖啡类型在售，该怎么计算呢？</li>
<li>应用 COUNT 聚合函数之前，加上 <code>DISTINCT</code> 关键字就。</li>
</ul>
</li>
</ul>
<p>应用法则：</p>
<ul>
<li>COUNT 聚合函数运算结果与参数有关，COUNT(*) &#x2F; COUNT(1) 得到包含 NULL 值的所有行，COUNT(&lt;列名&gt;) 得到不包含 NULL 值的所有行。</li>
<li>聚合函数不处理包含 NULL 值的行，但是 COUNT(*) 除外。</li>
<li>MAX &#x2F; MIN 函数适用于文本类型和数字类型的列，而 SUM &#x2F; AVG 函数仅适用于数字类型的列。</li>
<li>在聚合函数的参数中使用 DISTINCT 关键字，可以得到删除重复值的聚合结果。</li>
</ul>
<h3 id="2-4-对表分组"><a href="#2-4-对表分组" class="headerlink" title="2.4 对表分组"></a>2.4 对表分组</h3><h4 id="2-4-1-GROUP-BY"><a href="#2-4-1-GROUP-BY" class="headerlink" title="2.4.1 GROUP BY"></a>2.4.1 GROUP BY</h4><p>将现有的数据按照某列来汇总统计</p>
<ul>
<li>GROUP BY</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">&lt;</span>列名<span class="number">1</span><span class="operator">&gt;</span>,<span class="operator">&lt;</span>列名<span class="number">2</span><span class="operator">&gt;</span>, <span class="operator">&lt;</span>列名<span class="number">3</span><span class="operator">&gt;</span>, ……</span><br><span class="line">  <span class="keyword">FROM</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span></span><br><span class="line"> <span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="operator">&lt;</span>列名<span class="number">1</span><span class="operator">&gt;</span>, <span class="operator">&lt;</span>列名<span class="number">2</span><span class="operator">&gt;</span>, <span class="operator">&lt;</span>列名<span class="number">3</span><span class="operator">&gt;</span>, ……;</span><br></pre></td></tr></table></figure>

<p>例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 按照商品种类统计数据行数</span></span><br><span class="line"><span class="keyword">SELECT</span> product_type, <span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line">  <span class="keyword">FROM</span> product</span><br><span class="line"> <span class="keyword">GROUP</span> <span class="keyword">BY</span> product_type;</span><br><span class="line"> <span class="comment">-- 不含GROUP BY</span></span><br><span class="line"><span class="keyword">SELECT</span> product_type, <span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line">  <span class="keyword">FROM</span> product</span><br></pre></td></tr></table></figure>

<p><img src="https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/17/193825-979654.png" alt="image-20240117192824297"><img src="https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/17/192847-946555.png" alt="image-20240117192830807"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 在WHERE子句中使用GROUP BY</span></span><br><span class="line"><span class="keyword">SELECT</span> purchase_price, <span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line">  <span class="keyword">FROM</span> product</span><br><span class="line"> <span class="keyword">WHERE</span> product_type <span class="operator">=</span> <span class="string">&#x27;衣服&#x27;</span></span><br><span class="line"> <span class="keyword">GROUP</span> <span class="keyword">BY</span> purchase_price;</span><br></pre></td></tr></table></figure>

<h3 id="2-5-为聚合结果指定条件"><a href="#2-5-为聚合结果指定条件" class="headerlink" title="2.5 为聚合结果指定条件"></a>2.5 为聚合结果指定条件</h3><p>前面学习了如何得到分组聚合结果，那如何得到分组聚合结果的<strong>部分结果</strong>呢？</p>
<p><img src="https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/17/193909-287720.png" alt="image-20240117193909206"></p>
<ul>
<li>HAVING</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 常数</span></span><br><span class="line"><span class="keyword">SELECT</span> product_type, <span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line">  <span class="keyword">FROM</span> product</span><br><span class="line"> <span class="keyword">GROUP</span> <span class="keyword">BY</span> product_type</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 错误形式（因为product_name不包含在GROUP BY聚合键中）</span></span><br><span class="line"><span class="keyword">SELECT</span> product_type, <span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line">  <span class="keyword">FROM</span> product</span><br><span class="line"> <span class="keyword">GROUP</span> <span class="keyword">BY</span> product_type</span><br><span class="line"><span class="keyword">HAVING</span> product_name <span class="operator">=</span> <span class="string">&#x27;圆珠笔&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="2-7-对查询结果排序"><a href="#2-7-对查询结果排序" class="headerlink" title="2.7 对查询结果排序"></a>2.7 对查询结果排序</h3><ul>
<li>ORDER BY</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">&lt;</span>列名<span class="number">1</span><span class="operator">&gt;</span>, <span class="operator">&lt;</span>列名<span class="number">2</span><span class="operator">&gt;</span>, <span class="operator">&lt;</span>列名<span class="number">3</span><span class="operator">&gt;</span>, ……</span><br><span class="line">  <span class="keyword">FROM</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span></span><br><span class="line"> <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="operator">&lt;</span>排序基准列<span class="number">1</span><span class="operator">&gt;</span> [<span class="keyword">ASC</span>, <span class="keyword">DESC</span>], <span class="operator">&lt;</span>排序基准列<span class="number">2</span><span class="operator">&gt;</span> [<span class="keyword">ASC</span>, <span class="keyword">DESC</span>], ……</span><br><span class="line"> <span class="comment">-- ASC 升序（默认）</span></span><br><span class="line"> <span class="comment">-- DESC 降序</span></span><br></pre></td></tr></table></figure>

<p>例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 降序排列</span></span><br><span class="line"><span class="keyword">SELECT</span> product_id, product_name, sale_price, purchase_price</span><br><span class="line">  <span class="keyword">FROM</span> product</span><br><span class="line"> <span class="keyword">ORDER</span> <span class="keyword">BY</span> sale_price <span class="keyword">DESC</span>;</span><br><span class="line"> <span class="comment">-- 多个排序键</span></span><br><span class="line"><span class="keyword">SELECT</span> product_id, product_name, sale_price, purchase_price</span><br><span class="line">  <span class="keyword">FROM</span> product</span><br><span class="line"> <span class="keyword">ORDER</span> <span class="keyword">BY</span> sale_price, product_id;</span><br><span class="line"><span class="comment">-- 当用于排序的列名中含有NULL时，NULL会在开头或末尾进行汇总。</span></span><br><span class="line"><span class="keyword">SELECT</span> product_id, product_name, sale_price, purchase_price</span><br><span class="line">  <span class="keyword">FROM</span> product</span><br><span class="line"> <span class="keyword">ORDER</span> <span class="keyword">BY</span> purchase_price;</span><br></pre></td></tr></table></figure>

<p><img src="https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/17/194608-421859.png" alt="image-20240117194559533"><img src="https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/17/194638-270742.png" alt="image-20240117194611327"></p>
<p><img src="https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/17/194645-211947.png" alt="image-20240117194643249"></p>
<h4 id="2-7-1-别名"><a href="#2-7-1-别名" class="headerlink" title="2.7.1 别名"></a>2.7.1 别名</h4><p>GROUP BY 子句中不能使用SELECT 子句中定义的别名，但是在 ORDER BY 子句中却可以使用别名。为什么在GROUP BY中不可以而在ORDER BY中可以呢？</p>
<p>这是因为 SQL 在使用 HAVING 子句时 SELECT 语句的执行顺序为：</p>
<p>FROM → WHERE → GROUP BY → SELECT → HAVING → ORDER BY</p>
<p>其中 SELECT 的执行顺序在 GROUP BY 子句之后，ORDER BY 子句之前。</p>
<p>当在 ORDER BY 子句中使用别名时，已经知道了 SELECT 子句设置的别名，但是在 GROUP BY 子句执行时还不知道别名的存在，所以在 ORDER BY 子句中可以使用别名，但是在GROUP BY中不能使用别名。</p>
<h4 id="2-7-2-ORDER-BY-NULL"><a href="#2-7-2-ORDER-BY-NULL" class="headerlink" title="2.7.2 ORDER BY + NULL"></a>2.7.2 ORDER BY + NULL</h4><p>在MySQL中，<code>NULL</code> 值被认为比任何 <code>非NULL</code> 值低。因此，当顺序为 ASC（升序）时，<code>NULL</code> 值出现在第一位，而当顺序为 DESC（降序）时，则排序在最后。</p>
<p>使用如下代码构建示例表：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">user</span> (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    date_login <span class="type">DATE</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (id)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">user</span>(name, date_login) <span class="keyword">VALUES</span></span><br><span class="line">(<span class="keyword">NULL</span>,    <span class="string">&#x27;2017-03-12&#x27;</span>), </span><br><span class="line">(<span class="string">&#x27;john&#x27;</span>,   <span class="keyword">NULL</span>), </span><br><span class="line">(<span class="string">&#x27;david&#x27;</span>, <span class="string">&#x27;2016-12-24&#x27;</span>), </span><br><span class="line">(<span class="string">&#x27;zayne&#x27;</span>, <span class="string">&#x27;2017-03-02&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>一般有两种情况</p>
<ul>
<li><h5 id="将-NULL-值排在末行，同时将所有-非NULL-值按升序排列。"><a href="#将-NULL-值排在末行，同时将所有-非NULL-值按升序排列。" class="headerlink" title="将 NULL 值排在末行，同时将所有 非NULL 值按升序排列。"></a>将 <code>NULL</code> 值排在末行，同时将所有 <code>非NULL</code> 值按升序排列。</h5><ul>
<li><p>数字 or 日期类型</p>
<ul>
<li><p>可以在排序字段前添加一个负号（minus）来得到反向排序。（<code>-1、-2、-3....-∞</code>）</p>
</li>
<li><pre><code class="sql">SELECT * FROM user 
 ORDER BY -date_login DESC;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  - ![image-20240117203403518](https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/17/203413-147629.png)</span><br><span class="line"></span><br><span class="line">- 字符型 or 字符型数字</span><br><span class="line"></span><br><span class="line">  - 不一定能得到期望的排序结果，可以使用 `IS NULL` 比较运算符。另外 `ISNULL( )` 函数等同于使用 `IS NULL` 比较运算符。</span><br><span class="line"></span><br><span class="line">  - ```sql</span><br><span class="line">    -- IS NULL</span><br><span class="line">    SELECT * FROM user </span><br><span class="line">     ORDER BY name IS NULL ASC,name ASC;</span><br><span class="line">     </span><br><span class="line">    -- ISNULL()</span><br><span class="line">    SELECT * FROM user </span><br><span class="line">     ORDER BY ISNULL(name) ASC,name ASC;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
<li><p><img src="https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/17/203527-405401.png" alt="image-20240117203510455"><img src="https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/17/203540-322523.png" alt="image-20240117203517080"></p>
</li>
<li><p>上述语句先使用 <code>ISNULL(name)</code> 字段进行升序排列，而只有当 <code>name</code> 列值为 <code>NULL</code> 时，<code>ISNULL(name)</code> 才为真，所以其排到末行，而 <code>name ASC</code> 则实现了 <code>非NULL</code> 值升序排列。</p>
</li>
</ul>
</li>
<li><p>COALESCE</p>
<ul>
<li>&#96;&#96;&#96;sql<br>SELECT * FROM user<br> ORDER BY COALESCE(name, ‘zzzzz’) ASC;<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    - ![image-20240117203638186](https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/17/203639-420656.png)</span><br><span class="line"></span><br><span class="line">- ##### 将 `NULL` 值排在首行，同时将所有 `非NULL` 值按倒序排列。</span><br><span class="line"></span><br><span class="line">  - 数字 or 日期，还是要`-`号</span><br><span class="line"></span><br><span class="line">    - ```sql</span><br><span class="line">      SELECT * FROM user </span><br><span class="line">       ORDER BY -date_login ASC;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>字符型或者字符型数字</p>
<ul>
<li><p>此方法不一定能得到期望的排序结果，可以使用 <code>IS NOT NULL</code> 比较运算符。另外 <code>!ISNULL( )</code> 函数等同于使用 <code>IS NOT NULL</code> 比较运算符。</p>
</li>
<li><p>&#96;&#96;&#96;sql<br>– IS NOT NULL<br>SELECT * FROM user<br> ORDER BY name IS NOT NULL ASC,name DESC;</p>
<p>– !ISNULL()<br>SELECT * FROM user<br> ORDER BY !ISNULL(name) ASC,name DESC;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- COALESCE</span><br><span class="line"></span><br><span class="line">  - ```sql</span><br><span class="line">    SELECT * FROM user </span><br><span class="line">     ORDER BY COALESCE(name, &#x27;zzzzz&#x27;) DESC;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="3-复杂的查询"><a href="#3-复杂的查询" class="headerlink" title="3 复杂的查询"></a>3 复杂的查询</h2><h3 id="3-1-视图"><a href="#3-1-视图" class="headerlink" title="3.1 视图"></a>3.1 视图</h3><p>视图是一个虚拟的表，依据SELECT语句来创建。可基于真实的表，也可以基于视图。</p>
<ul>
<li>为什么会存在视图</li>
</ul>
<ol>
<li>通过定义视图可以将频繁使用的SELECT语句保存以提高效率。</li>
<li>通过定义视图可以使用户看到的数据更加清晰。</li>
<li>通过定义视图可以不对外公开数据表全部字段，增强数据的保密性。</li>
<li>通过定义视图可以降低数据的冗余。</li>
</ol>
<ul>
<li><p>基本语法</p>
<ul>
<li>&#96;&#96;&#96;sql<br>CREATE VIEW &lt;视图名称&gt;(&lt;列名1&gt;,&lt;列名2&gt;,…) AS &lt;SELECT语句&gt;<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  - 列要对应</span><br><span class="line"></span><br><span class="line">  - 视图名称唯一</span><br><span class="line"></span><br><span class="line">- 注意事项</span><br><span class="line"></span><br><span class="line">一般的DBMS中，定义视图时，不能用ORDER BY语句。视图和表一样，数据行是没有顺序的。</span><br><span class="line"></span><br><span class="line">错误例子：</span><br><span class="line"></span><br><span class="line">```sql</span><br><span class="line">CREATE VIEW productsum (product_type, cnt_product)</span><br><span class="line">AS</span><br><span class="line">SELECT product_type, COUNT(*)</span><br><span class="line">  FROM product</span><br><span class="line"> GROUP BY product_type</span><br><span class="line"> ORDER BY product_type;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h4 id="3-1-2-视图创建实例"><a href="#3-1-2-视图创建实例" class="headerlink" title="3.1.2 视图创建实例"></a>3.1.2 视图创建实例</h4><ul>
<li>基于单表的视图</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> productsum (product_type, cnt_product)</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> product_type, <span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line">  <span class="keyword">FROM</span> product</span><br><span class="line"> <span class="keyword">GROUP</span> <span class="keyword">BY</span> product_type ;</span><br></pre></td></tr></table></figure>

<ul>
<li>基于多表的视图</li>
</ul>
<ol>
<li>创建多表</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> shop_product</span><br><span class="line">(shop_id    <span class="type">CHAR</span>(<span class="number">4</span>)       <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line"> shop_name  <span class="type">VARCHAR</span>(<span class="number">200</span>)  <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line"> product_id <span class="type">CHAR</span>(<span class="number">4</span>)       <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line"> quantity   <span class="type">INTEGER</span>       <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line"> <span class="keyword">PRIMARY</span> KEY (shop_id, product_id));</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> shop_product (shop_id, shop_name, product_id, quantity) <span class="keyword">VALUES</span> (<span class="string">&#x27;000A&#x27;</span>,	<span class="string">&#x27;东京&#x27;</span>,		<span class="string">&#x27;0001&#x27;</span>,	<span class="number">30</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> shop_product (shop_id, shop_name, product_id, quantity) <span class="keyword">VALUES</span> (<span class="string">&#x27;000A&#x27;</span>,	<span class="string">&#x27;东京&#x27;</span>,		<span class="string">&#x27;0002&#x27;</span>,	<span class="number">50</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> shop_product (shop_id, shop_name, product_id, quantity) <span class="keyword">VALUES</span> (<span class="string">&#x27;000A&#x27;</span>,	<span class="string">&#x27;东京&#x27;</span>,		<span class="string">&#x27;0003&#x27;</span>,	<span class="number">15</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> shop_product (shop_id, shop_name, product_id, quantity) <span class="keyword">VALUES</span> (<span class="string">&#x27;000B&#x27;</span>,	<span class="string">&#x27;名古屋&#x27;</span>,	<span class="string">&#x27;0002&#x27;</span>,	<span class="number">30</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> shop_product (shop_id, shop_name, product_id, quantity) <span class="keyword">VALUES</span> (<span class="string">&#x27;000B&#x27;</span>,	<span class="string">&#x27;名古屋&#x27;</span>,	<span class="string">&#x27;0003&#x27;</span>,	<span class="number">120</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> shop_product (shop_id, shop_name, product_id, quantity) <span class="keyword">VALUES</span> (<span class="string">&#x27;000B&#x27;</span>,	<span class="string">&#x27;名古屋&#x27;</span>,	<span class="string">&#x27;0004&#x27;</span>,	<span class="number">20</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> shop_product (shop_id, shop_name, product_id, quantity) <span class="keyword">VALUES</span> (<span class="string">&#x27;000B&#x27;</span>,	<span class="string">&#x27;名古屋&#x27;</span>,	<span class="string">&#x27;0006&#x27;</span>,	<span class="number">10</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> shop_product (shop_id, shop_name, product_id, quantity) <span class="keyword">VALUES</span> (<span class="string">&#x27;000B&#x27;</span>,	<span class="string">&#x27;名古屋&#x27;</span>,	<span class="string">&#x27;0007&#x27;</span>,	<span class="number">40</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> shop_product (shop_id, shop_name, product_id, quantity) <span class="keyword">VALUES</span> (<span class="string">&#x27;000C&#x27;</span>,	<span class="string">&#x27;大阪&#x27;</span>,		<span class="string">&#x27;0003&#x27;</span>,	<span class="number">20</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> shop_product (shop_id, shop_name, product_id, quantity) <span class="keyword">VALUES</span> (<span class="string">&#x27;000C&#x27;</span>,	<span class="string">&#x27;大阪&#x27;</span>,		<span class="string">&#x27;0004&#x27;</span>,	<span class="number">50</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> shop_product (shop_id, shop_name, product_id, quantity) <span class="keyword">VALUES</span> (<span class="string">&#x27;000C&#x27;</span>,	<span class="string">&#x27;大阪&#x27;</span>,		<span class="string">&#x27;0006&#x27;</span>,	<span class="number">90</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> shop_product (shop_id, shop_name, product_id, quantity) <span class="keyword">VALUES</span> (<span class="string">&#x27;000C&#x27;</span>,	<span class="string">&#x27;大阪&#x27;</span>,		<span class="string">&#x27;0007&#x27;</span>,	<span class="number">70</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> shop_product (shop_id, shop_name, product_id, quantity) <span class="keyword">VALUES</span> (<span class="string">&#x27;000D&#x27;</span>,	<span class="string">&#x27;福冈&#x27;</span>,		<span class="string">&#x27;0001&#x27;</span>,	<span class="number">100</span>);</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>创建视图</li>
</ol>
<p>基于product和shop_product</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> view_shop_product(product_type, sale_price, shop_name)</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> product_type, sale_price, shop_name</span><br><span class="line">  <span class="keyword">FROM</span> product,</span><br><span class="line">       shop_product</span><br><span class="line"> <span class="keyword">WHERE</span> product.product_id <span class="operator">=</span> shop_product.product_id;</span><br></pre></td></tr></table></figure>

<p><img src="https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/24/172316-565552.png" alt="image-20240124172257500"></p>
<ol start="3">
<li>在创建的视图<code>view_shop_product</code>的基础上查询</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sale_price, shop_name</span><br><span class="line">  <span class="keyword">FROM</span> view_shop_product</span><br><span class="line"> <span class="keyword">WHERE</span> product_type <span class="operator">=</span> <span class="string">&#x27;衣服&#x27;</span>;</span><br></pre></td></tr></table></figure>



<p><img src="https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/24/172628-730276.png" alt="image-20240124172521028"></p>
<h4 id="3-1-3-视图修改"><a href="#3-1-3-视图修改" class="headerlink" title="3.1.3 视图修改"></a>3.1.3 视图修改</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">VIEW</span> <span class="operator">&lt;</span>视图名<span class="operator">&gt;</span> <span class="keyword">AS</span> <span class="operator">&lt;</span><span class="keyword">SELECT</span>语句<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>

<p>将上述视图修改：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">VIEW</span> productSum</span><br><span class="line">    <span class="keyword">AS</span></span><br><span class="line">        <span class="keyword">SELECT</span> product_type, sale_price</span><br><span class="line">          <span class="keyword">FROM</span> Product</span><br><span class="line">         <span class="keyword">WHERE</span> regist_date <span class="operator">&gt;</span> <span class="string">&#x27;2009-09-11&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/24/173332-64521.png" alt="image-20240124172836307"></p>
<h4 id="3-1-4-视图更新"><a href="#3-1-4-视图更新" class="headerlink" title="3.1.4 视图更新"></a>3.1.4 视图更新</h4><p>不可被更新的视图含有：</p>
<ul>
<li><p>聚合函数 SUM()、MIN()、MAX()、COUNT() 等。</p>
</li>
<li><p>DISTINCT 关键字。</p>
</li>
<li><p>GROUP BY 子句。</p>
</li>
<li><p>HAVING 子句。</p>
</li>
<li><p>UNION 或 UNION ALL 运算符。</p>
</li>
<li><p>FROM 子句中包含多个表。</p>
</li>
<li><p>更新视图</p>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> productsum</span><br><span class="line">   <span class="keyword">SET</span> sale_price <span class="operator">=</span> <span class="string">&#x27;5000&#x27;</span></span><br><span class="line"> <span class="keyword">WHERE</span> product_type <span class="operator">=</span> <span class="string">&#x27;办公用品&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/24/173638-163984.png" alt="image-20240124173553339"></p>
<p>ps:在原表中也更新了</p>
<p><img src="https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/24/173755-475747.png" alt="image-20240124173704555"></p>
<p><strong>总体来说，不推荐这种方式，有可能导致数据不一致。</strong></p>
<h4 id="3-1-5-删除视图"><a href="#3-1-5-删除视图" class="headerlink" title="3.1.5 删除视图"></a>3.1.5 删除视图</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> <span class="operator">&lt;</span>视图名<span class="number">1</span><span class="operator">&gt;</span> [ , <span class="operator">&lt;</span>视图名<span class="number">2</span><span class="operator">&gt;</span> …]</span><br><span class="line"><span class="comment">-- 删除刚刚创建的productsum</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> productsum;</span><br></pre></td></tr></table></figure>





<h3 id="3-2-子查询"><a href="#3-2-子查询" class="headerlink" title="3.2  子查询"></a>3.2  子查询</h3><h4 id="3-2-1-嵌套子查询"><a href="#3-2-1-嵌套子查询" class="headerlink" title="3.2.1 嵌套子查询"></a>3.2.1 嵌套子查询</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> product_type, cnt_product</span><br><span class="line"><span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">        <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> product_type, </span><br><span class="line">                      <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">AS</span> cnt_product</span><br><span class="line">                <span class="keyword">FROM</span> product </span><br><span class="line">               <span class="keyword">GROUP</span> <span class="keyword">BY</span> product_type) <span class="keyword">AS</span> productsum</span><br><span class="line">       <span class="keyword">WHERE</span> cnt_product <span class="operator">=</span> <span class="number">4</span>) <span class="keyword">AS</span> productsum2;</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240124175155939.png" alt="image-20240124175155939"></p>
<ul>
<li>最内层查询命名为productsum</li>
<li>第二层将个数 &#x3D; 4的商品查询</li>
<li>最外层查询 product_type 和 cnt_product</li>
</ul>
<h4 id="3-2-2-标量子查询"><a href="#3-2-2-标量子查询" class="headerlink" title="3.2.2 标量子查询"></a>3.2.2 标量子查询</h4><p>返回表中具体的<strong>某一行的某一列</strong>。</p>
<p>例：查找价格大于平均值的商品</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> product_id, product_name, sale_price</span><br><span class="line">  <span class="keyword">FROM</span> product</span><br><span class="line"> <span class="keyword">WHERE</span> sale_price <span class="operator">&gt;</span> (<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(sale_price) <span class="keyword">FROM</span> product);</span><br><span class="line"> <span class="comment">-- 或</span></span><br><span class="line"> <span class="keyword">SELECT</span> product_id,</span><br><span class="line">       product_name,</span><br><span class="line">       sale_price,</span><br><span class="line">       (<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(sale_price)</span><br><span class="line">          <span class="keyword">FROM</span> product) <span class="keyword">AS</span> avg_price</span><br><span class="line">  <span class="keyword">FROM</span> product;</span><br></pre></td></tr></table></figure>

<p><img src="https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/24/180238-153250.png" alt="image-20240124175824805"><img src="https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/24/183209-557894.png" alt="image-20240124175836028"></p>
<p>结果不一样</p>
<h4 id="3-3-3关联子查询"><a href="#3-3-3关联子查询" class="headerlink" title="3.3.3关联子查询"></a>3.3.3关联子查询</h4><h2 id="4-集合运算"><a href="#4-集合运算" class="headerlink" title="4 集合运算"></a>4 集合运算</h2><h3 id="4-1-表的加减运算"><a href="#4-1-表的加减运算" class="headerlink" title="4.1 表的加减运算"></a>4.1 表的加减运算</h3><h4 id="4-1-1-加法-—-UNION"><a href="#4-1-1-加法-—-UNION" class="headerlink" title="4.1.1 加法 —- UNION"></a>4.1.1 加法 —- UNION</h4><p><strong>UNION</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> product_id, product_name</span><br><span class="line">  <span class="keyword">FROM</span> product</span><br><span class="line"> <span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> product_id, product_name</span><br><span class="line">  <span class="keyword">FROM</span> product2;</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240124183500517.png" alt="image-20240124183500517"></p>
<p>将两张表中出现的元素都查询出来。</p>
<p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240124183535531.png" alt="image-20240124183535531"></p>
<p>有时UNION也可以用OR改写（或者xx的时候）</p>
<ul>
<li>包含重复行的集合运算 <strong>UNION ALL</strong></li>
</ul>
<p>直接用UNION可以发现，会自动去除重复行，如果想保留：UNION –&gt; UNION ALL</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 保留重复行</span></span><br><span class="line"><span class="keyword">SELECT</span> product_type</span><br><span class="line">  <span class="keyword">FROM</span> Product</span><br><span class="line"> <span class="keyword">UNION</span> <span class="keyword">ALL</span></span><br><span class="line"><span class="keyword">SELECT</span> product_type</span><br><span class="line">  <span class="keyword">FROM</span> Product2;</span><br></pre></td></tr></table></figure>



<ul>
<li>隐式数据类型转换</li>
</ul>
<p>我们会把类型完全一致, 并且代表相同属性的列使用 UNION 合并到一起显示, 但有时候, 即使数据类型不完全相同, 也会通过隐式类型转换来将两个类型不同的列放在一列里显示, 例如字符串和数值类型:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> product_id, product_name, <span class="string">&#x27;1&#x27;</span></span><br><span class="line">  <span class="keyword">FROM</span> Product</span><br><span class="line"> <span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> product_id, product_name,sale_price</span><br><span class="line">  <span class="keyword">FROM</span> Product2;</span><br></pre></td></tr></table></figure>



<p><img src="https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/24/184601-668478.png" alt="image-20240124184321676"></p>
<h4 id="4-1-2-交集"><a href="#4-1-2-交集" class="headerlink" title="4.1.2 交集"></a>4.1.2 交集</h4><p>MySQL 8.0 不支持INTERSECT直接求交集，可通过<code>inner join</code>来求交集</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> p1.product_id, p1.product_name</span><br><span class="line">  <span class="keyword">FROM</span> Product p1</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> Product2 p2</span><br><span class="line"><span class="keyword">ON</span> p1.product_id<span class="operator">=</span>p2.product_id</span><br></pre></td></tr></table></figure>

<p><img src="https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/24/184942-526001.png" alt="image-20240124184651481"></p>
<h4 id="4-1-3-差集、补集与表的减法"><a href="#4-1-3-差集、补集与表的减法" class="headerlink" title="4.1.3 差集、补集与表的减法"></a>4.1.3 差集、补集与表的减法</h4><p>MySQL 8.0 还不支持 表的减法运算符 EXCEPT，但可使用<code>NOT IN</code>代替。</p>
<p>例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 找出只存在于Product表但不存在于Product2表的商品。</span></span><br><span class="line"><span class="comment">-- 使用 NOT IN 子句的实现方法</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> </span><br><span class="line">  <span class="keyword">FROM</span> Product</span><br><span class="line"> <span class="keyword">WHERE</span> product_id <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="keyword">SELECT</span> product_id </span><br><span class="line">                            <span class="keyword">FROM</span> Product2)</span><br></pre></td></tr></table></figure>

<p><img src="https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/24/185231-909705.png" alt="image-20240124185139073"></p>
<h3 id="4-2-连结-JOIN"><a href="#4-2-连结-JOIN" class="headerlink" title="4.2 连结  JOIN"></a>4.2 连结  <strong>JOIN</strong></h3><p>上面集合运算是针对数据的行的变化，而连结针对列。</p>
<p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240124185626662.png" alt="image-20240124185626662"></p>
<p>连结(JOIN)就是使用某种关联条件(一般是使用相等判断谓词”&#x3D;”), 将其他表中的列添加过来, 进行“添加列”的集合运算. 可以说,连结是 SQL 查询的核心操作, 掌握了连结, 能够从两张甚至多张表中获取列, 能够将过去使用关联子查询等过于复杂的查询简化为更加易读的形式, 以及进行一些更加复杂的查询。</p>
<h4 id="4-2-1-内连结-—-INNER-JOIN"><a href="#4-2-1-内连结-—-INNER-JOIN" class="headerlink" title="4.2.1 内连结  —- INNER JOIN"></a>4.2.1 内连结  —- <code>INNER JOIN</code></h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 内连结</span></span><br><span class="line"><span class="keyword">FROM</span> <span class="operator">&lt;</span>tb_1<span class="operator">&gt;</span> <span class="keyword">INNER</span> <span class="keyword">JOIN</span> <span class="operator">&lt;</span>tb_2<span class="operator">&gt;</span> <span class="keyword">ON</span> <span class="operator">&lt;</span><span class="keyword">condition</span>(s)<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>使用内连结从两个表获取信息</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> SP.shop_id</span><br><span class="line">       ,SP.shop_name</span><br><span class="line">       ,SP.product_id</span><br><span class="line">       ,P.product_name</span><br><span class="line">       ,P.product_type</span><br><span class="line">       ,P.sale_price</span><br><span class="line">       ,SP.quantity</span><br><span class="line"><span class="comment">-- 连结表</span></span><br><span class="line">  <span class="keyword">FROM</span> ShopProduct <span class="keyword">AS</span> SP</span><br><span class="line"> <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Product <span class="keyword">AS</span> P</span><br><span class="line"> <span class="comment">-- ON来说明连结条件</span></span><br><span class="line">    <span class="keyword">ON</span> SP.product_id <span class="operator">=</span> P.product_id;</span><br></pre></td></tr></table></figure>

<p><img src="https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/25/153448-668659.png" alt="image-20240125153448710"></p>
<ul>
<li>结合 WHERE 子句使用内连结</li>
</ul>
<p>WHERE要写在ON后面</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">  <span class="keyword">FROM</span> (<span class="comment">-- 第一步查询的结果</span></span><br><span class="line">        <span class="keyword">SELECT</span> SP.shop_id</span><br><span class="line">               ,SP.shop_name</span><br><span class="line">               ,SP.product_id</span><br><span class="line">               ,P.product_name</span><br><span class="line">               ,P.product_type</span><br><span class="line">               ,P.sale_price</span><br><span class="line">               ,SP.quantity</span><br><span class="line">          <span class="keyword">FROM</span> ShopProduct <span class="keyword">AS</span> SP</span><br><span class="line">         <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Product <span class="keyword">AS</span> P</span><br><span class="line">            <span class="keyword">ON</span> SP.product_id <span class="operator">=</span> P.product_id) <span class="keyword">AS</span> STEP1</span><br><span class="line"> <span class="keyword">WHERE</span> shop_name <span class="operator">=</span> <span class="string">&#x27;东京&#x27;</span></span><br><span class="line">   <span class="keyword">AND</span> product_type <span class="operator">=</span> <span class="string">&#x27;衣服&#x27;</span> ;</span><br></pre></td></tr></table></figure>

<p><img src="https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/25/154228-867415.png" alt="image-20240125154228394"></p>
<ul>
<li>结合 GROUP BY 子句使用内连结</li>
</ul>
<p>结合 GROUP BY 子句使用内连结, 需要根据分组列位于哪个表区别对待。</p>
<p>最简单的情形, 是在内连结之前就使用 GROUP BY 子句.</p>
<p>但是如果分组列和被聚合的列不在同一张表, 且二者都未被用于连结两张表, 则只能先连结, 再聚合。</p>
<p>例：每个商店中, 售价最高的商品的售价分别是多少?</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sp.shop_id, sp.shop_name, <span class="built_in">MAX</span>(p.sale_price) <span class="keyword">AS</span> max_price</span><br><span class="line"><span class="keyword">FROM</span> shopproduct <span class="keyword">AS</span> sp</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> product <span class="keyword">AS</span> p</span><br><span class="line"><span class="keyword">ON</span> sp.product_id <span class="operator">=</span> p.product_id</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> sp.shop_id, sp.shop_name</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240125154912322.png" alt="image-20240125154912322"></p>
<h4 id="4-2-2-自连结-—-SELF-JOIN"><a href="#4-2-2-自连结-—-SELF-JOIN" class="headerlink" title="4.2.2 自连结 —- SELF JOIN"></a>4.2.2 自连结 —- <code>SELF JOIN</code></h4><p>例：找出每个商品种类当中售价高于该类商品的平均售价的商品</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>  P1.product_id</span><br><span class="line">       ,P1.product_name</span><br><span class="line">       ,P1.product_type</span><br><span class="line">       ,P1.sale_price</span><br><span class="line">       ,P2.avg_price</span><br><span class="line">  <span class="keyword">FROM</span> Product <span class="keyword">AS</span> P1</span><br><span class="line"> <span class="keyword">INNER</span> <span class="keyword">JOIN</span> </span><br><span class="line"> <span class="comment">-- 找出平均价</span></span><br><span class="line">   (<span class="keyword">SELECT</span> product_type,<span class="built_in">AVG</span>(sale_price) <span class="keyword">AS</span> avg_price </span><br><span class="line">      <span class="keyword">FROM</span> Product </span><br><span class="line">     <span class="keyword">GROUP</span> <span class="keyword">BY</span> product_type) <span class="keyword">AS</span> P2 </span><br><span class="line">    <span class="keyword">ON</span> P1.product_type <span class="operator">=</span> P2.product_type</span><br><span class="line"> <span class="keyword">WHERE</span> P1.sale_price <span class="operator">&gt;</span> P2.avg_price;</span><br></pre></td></tr></table></figure>

<p><img src="https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/25/160304-360168.png" alt="image-20240125155820273"></p>
<h4 id="4-2-4-自然连结-—-NATURAL-JOIN"><a href="#4-2-4-自然连结-—-NATURAL-JOIN" class="headerlink" title="4.2.4 自然连结 —- NATURAL JOIN"></a>4.2.4 自然连结 —- <code>NATURAL JOIN</code></h4><p>自然连结并不是区别于内连结和外连结的第三种连结, 它其实是内连结的一种特例–当两个表进行自然连结时, 会按照两个表中都包含的列名来进行等值内连结, 此时无需使用 ON 来指定连接条件。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span>  <span class="keyword">FROM</span> shopproduct <span class="keyword">NATURAL</span> <span class="keyword">JOIN</span> Product</span><br></pre></td></tr></table></figure>

<h3 id="4-3-外连结-—-OUTER-JOIN"><a href="#4-3-外连结-—-OUTER-JOIN" class="headerlink" title="4.3  外连结 —- OUTER JOIN"></a>4.3  外连结 —- <code>OUTER JOIN</code></h3><p>内连结会丢弃两张表中不满足 ON 条件的行,和内连结相对的就是外连结. 外连结会根据外连结的种类有选择地保留无法匹配到的行。</p>
<p>按照保留的行位于哪张表,外连结有三种形式: 左连结, 右连结和全外连结。</p>
<p>左连结会保存左表中无法按照 ON 子句匹配到的行, 此时对应右表的行均为缺失值; 右连结则会保存右表中无法按照 ON 子句匹配到的行, 此时对应左表的行均为缺失值; 而全外连结则会同时保存两个表中无法按照 ON子句匹配到的行, 相应的另一张表中的行用缺失值填充。</p>
<p>三种外连结的对应语法分别为:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 左连结     </span></span><br><span class="line"><span class="keyword">FROM</span> <span class="operator">&lt;</span>tb_1<span class="operator">&gt;</span> <span class="keyword">LEFT</span>  <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> <span class="operator">&lt;</span>tb_2<span class="operator">&gt;</span> <span class="keyword">ON</span> <span class="operator">&lt;</span><span class="keyword">condition</span>(s)<span class="operator">&gt;</span></span><br><span class="line"><span class="comment">-- 右连结     </span></span><br><span class="line"><span class="keyword">FROM</span> <span class="operator">&lt;</span>tb_1<span class="operator">&gt;</span> <span class="keyword">RIGHT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> <span class="operator">&lt;</span>tb_2<span class="operator">&gt;</span> <span class="keyword">ON</span> <span class="operator">&lt;</span><span class="keyword">condition</span>(s)<span class="operator">&gt;</span></span><br><span class="line"><span class="comment">-- 全外连结</span></span><br><span class="line"><span class="keyword">FROM</span> <span class="operator">&lt;</span>tb_1<span class="operator">&gt;</span> <span class="keyword">FULL</span>  <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> <span class="operator">&lt;</span>tb_2<span class="operator">&gt;</span> <span class="keyword">ON</span> <span class="operator">&lt;</span><span class="keyword">condition</span>(s)<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="4-3-1-左连结（LEFT-JOIN）和右连结（RIGHT-JOIN）"><a href="#4-3-1-左连结（LEFT-JOIN）和右连结（RIGHT-JOIN）" class="headerlink" title="4.3.1 左连结（LEFT JOIN）和右连结（RIGHT JOIN）"></a>4.3.1 左连结（<code>LEFT JOIN</code>）和右连结（<code>RIGHT JOIN</code>）</h4><p>由于连结时可以交换左表和右表的位置, 因此左连结和右连结并没有本质区别.接下来我们先以左连结为例进行学习. 所有的内容在调换两个表的前后位置, 并将左连结改为右连结之后, 都能得到相同的结果. 稍后再介绍全外连结的概念。</p>
<h4 id="4-3-2-左连结-—-LEFT-JOIN"><a href="#4-3-2-左连结-—-LEFT-JOIN" class="headerlink" title="4.3.2 左连结 —- LEFT JOIN"></a>4.3.2 左连结 —- <code>LEFT JOIN</code></h4><p>例：统计每种商品分别在哪些商店有售, 需要包括那些在每个商店都没货的商品。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> SP.shop_id</span><br><span class="line">       ,SP.shop_name</span><br><span class="line">       ,SP.product_id</span><br><span class="line">       ,P.product_name</span><br><span class="line">       ,P.sale_price</span><br><span class="line">  <span class="keyword">FROM</span> Product <span class="keyword">AS</span> P</span><br><span class="line">  <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> ShopProduct <span class="keyword">AS</span> SP</span><br><span class="line">    <span class="keyword">ON</span> SP.product_id <span class="operator">=</span> P.product_id;</span><br></pre></td></tr></table></figure>

<p><img src="https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/typora/202401/25/161135-669487.png" alt="image-20240125160959892"></p>
<p>顾名思义,使用 LEFT 时 FROM 子句中写在左侧的表是主表,使用 RIGHT 时右侧的表是主表</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Bella</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://www.bebella.cc/2024/01/15/SQL学习/">https://www.bebella.cc/2024/01/15/SQL学习/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/SQL/">SQL</a></div><nav id="pagination"><div class="next-post pull-right"><a href="/2024/01/15/Jupyter%E5%BF%AB%E6%8D%B7%E9%94%AE/"><span>Jupyter快捷键</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer class="footer-bg" style="background-image: url(https://bella-typora-1319711826.cos.ap-guangzhou.myqcloud.com/breathecc.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2022 - 2024 By Bella</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://unpkg.com/animejs@latest/lib/anime.min.js"></script><script src="https://unpkg.com/jquery@latest/dist/jquery.min.js"></script><script src="https://unpkg.com/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://unpkg.com/velocity-animate@latest/velocity.min.js"></script><script src="https://unpkg.com/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.1"></script><script src="/js/fancybox.js?version=1.9.1"></script><script src="/js/sidebar.js?version=1.9.1"></script><script src="/js/copy.js?version=1.9.1"></script><script src="/js/fireworks.js?version=1.9.1"></script><script src="/js/transition.js?version=1.9.1"></script><script src="/js/scroll.js?version=1.9.1"></script><script src="/js/head.js?version=1.9.1"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>